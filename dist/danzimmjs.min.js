/*! danzimmjs 27-02-2014 */
var ZimmBlog=function(){var a={},b=function(a,b){return"/"==a[a.length-1]?a+b:a+"/"+b};return a.createBlog=function(a,c,d){var e={},f=-1,g="",h=[],i=0,j=function(){var b,c=new XMLHttpRequest;c.open("GET",a,!1),c.send(),b=JSON.parse(c.responseText),h=b.files,i=b.files.length};return j(),e.draw=function(){var a=document.createElement("div"),b=document.createElement("div"),c=document.createElement("div"),f=document.createElement("div");return b.id=d+"_blog_content",b.classList.add("blogpost"),a.appendChild(b),b.innerHTML=g,c.innerHTML="Previous",f.innerHTML="Next",c.style["float"]="left",f.style["float"]="right",c.classList.add("blognav"),f.classList.add("blognav"),c.id="leftblognav",f.id="rightblognav",c.onclick=function(){e.previous()},f.onclick=function(){e.next()},a.appendChild(c),a.appendChild(f),a},e.showPost=function(a){if(0===i)return document.getElementById("rightblognav").style.display="none",document.getElementById("leftblognav").style.display="none",g="No posts found",void(document.getElementById(d+"_blog_content").innerHTML=g);if(a!=f){f=a;var e=new XMLHttpRequest;e.onreadystatechange=function(){4===e.readyState&&200===e.status&&(g=e.responseText,document.getElementById(d+"_blog_content").innerHTML=g)},e.open("GET",b(c,a),!0),e.send(),document.getElementById("rightblognav").style.display=a===i-1?"none":"block",document.getElementById("leftblognav").style.display=0===a?"none":"block"}},e.next=function(){var a=f;a++,a>=i&&(a=i-1),this.showPost(a)},e.previous=function(){var a=f;a--,0>a&&(a=0),this.showPost(a)},e},a}(),Cookies=function(){var a={};return a.set=function(a,b,c){var d,e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d="expires="+e.toGMTString(),document.cookie=a+"="+b+"; "+d},a.get=function(a){var b,c,d=a+"=",e=document.cookie.split(";");for(b=0;b<e.length;b++)if(c=e[b].trim(),0==c.indexOf(d))return c.substring(d.length,c.length);return""},a}(),DancingText=function(){var a={},b=function(a){var b={};return b.letter=a,b.size="100%",b.html=function(){return'<span class="dancingcharacter" style="font-size: '+this.size+'">'+this.letter+"</span>"},b};return a.dancetext=function(a){var c,d,e=[],f=0,g=a.innerHTML,f=-1;for(c=0;c<g.length;c++)e.push(b(g.charAt(c)));a.innerHTML=e.map(function(a){return a.html()}).join(""),d=function(a){for(a.objectAtIndex(f-1).style.fontSize="100%",a.objectAtIndex(f).style.fontSize="100%",a.objectAtIndex(f+1).style.fontSize="100%",oldindex=f;f==oldindex;)f=ZimmUtil.getRandomInt(0,e.length-1);f>0&&(a.objectAtIndex(f-1).style.fontSize="120%"),a.objectAtIndex(f).style.fontSize="150%",f<a.length-1&&(a.objectAtIndex(f+1).style.fontSize="120%"),setTimeout(d,700,a)},setTimeout(d,10,a.children)},a.dance=function(){var a=document.getElementsByClassName("dancingtext");ZimmUtil.addCSSRule(".dancingcharacter","transition: all 500ms; -webkit-transition: all 500ms;",1);for(var b=0;b<a.length;b++)this.dancetext(a[b])},a}(),Keys=function(){var a={},b=[],c=function(a){var b,c=[];for(i=0;i<a.length;i++)b=a[i],c.push("string"==typeof b?b.toLowerCase():"number"==typeof b&&b>=65&&90>=b?b+32:b);return c},d=function(a,b,d,e){var f={};return f.caseinsensitive=b,f.letters=f.caseinsensitive?c(a):a,f.callback=d,f.name=e,f};a.registerListener=function(a,c,e,f){b.push(d(a,c,e,f))},a.removeListenerForName=function(a){var c,d=[];for(b.forEach(function(b,c){b.name===a&&d.push(c)}),c=d.length-1;c>=0;c--)b.splice(d[c],1)},a.announce=function(a,d,e,f,g){b.forEach(function(b){-1!==b.letters.indexOf(a)?b.callback(a,d,e,f,g):b.caseinsensitive&&-1!==b.letters.indexOf(c([a])[0])&&b.callback(c([a])[0],d,e,f,g)})},a.registerCheatCode=function(a,b,c){var d=0;this.registerListener(a,!1,function(e){e===a[d]?d++:d=0,d==a.length&&(c(b),d=0)},b)};var e=function(b){a.announce(b.keyCode,b.shiftKey,b.altKey,b.metaKey,b.ctrlKey)};return a.start=function(){window.onkeydown=e},a.stop=function(){window.onkeydown=null},a}(),Matrix=function(){var a={},b={color:"#0F0",fontFamily:"Monaco",fontSize:15,letters:"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",speed:3,chance:.975,speedForColumn:function(){return 1},tailLength:10};a.letters={},a.letters.chinese="田由甲申甴电甶男甸甹町画甼甽甾甿畀畁畂畃畄畅畆畇畈畉畊畋界畍畎畏畐畑",a.letters.lowercaseEnglish="abcdefghijklmnopqrstuvwxyz",a.letters.uppercaseEnglish=a.letters.lowercaseEnglish.toUpperCase(),a.letters.digits="0123456789",a.letters.leet="1337leet",a.resetOptions=function(){a.options={};for(key in b)a.options[key]=b[key]},a.resetOptions();var c=function(a){var b=document.createElement("span"),c=0;return b.style.fontSize=a+"px",b.innerHTML="x",b.style.margin=b.style.padding="0",document.body.appendChild(b),c=b.offsetWidth,document.body.removeChild(b),c},d=function(a){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(b,function(a,b,c,d){return b+b+c+c+d+d});var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return c?{r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16)}:null},e=function(a){return new Array(a).join(" ")};return a.fly=function(b){var f,g,h,i,j,k,l=document.createElement("canvas"),m=l.getContext("2d"),n=a.options.letters+e(Math.floor(a.options.letters.length/2)),o=n.split(""),p=[],q=d(a.options.color),r="rgba("+q.r+","+q.g+","+q.b+",",s=c(a.options.fontSize);for(b.appendChild(l),l.width=b.clientWidth,l.height=b.clientHeight,i=Math.floor(l.width/s)+1,j=Math.floor(l.height/a.options.fontSize)+1,f=new Array(i),k=new Array(k),g=0;i>g;g++){for(p.push(new Array(j)),h=0;j>h;h++)p[g][h]={alpha:0,letter:" "};f[g]=0,p[g].ready=!0}var t=function(a,b,c,d,e,k){for(m.clearRect(0,0,l.width,l.height),m.font=a+"px "+c,g=0;i>g;g++){f[g]++;var n=!1;for(h=0;j>h;h++){var q=p[g][h];1===q.alpha?(n=!0,q.alpha-=1/(k+1)):n?(n=!1,q.alpha=1,q.letter=o[Math.floor(Math.random()*o.length)],h===j-1&&(p[g].ready=!0)):q.alpha-=1/(k+1),m.fillStyle=r+q.alpha+")",m.fillText(q.letter,g*b,h*a)}p[g].ready&&Math.random()>e&&(p[g].ready=!1,p[g][0].alpha=1,p[g][0].letter=o[Math.floor(Math.random()*o.length)])}},u=setInterval(t,100/a.options.speed,a.options.fontSize,s,a.options.fontFamily,a.options.color,a.options.chance,a.options.tailLength);return{id:u,elm:b,canvas:l}},a.land=function(a){clearInterval(a.id),a.elm.removeChild(a.canvas)},a}(),ZimmMenu=function(){var a={},b=a;return a.selectedClass="zimmlected",a.createMenu=function(a,c){var d,e,f={},g=document.createElement("ul");for(f.currentIndex=-1,f.clickHandler=function(){},e=function(b,c){if(f.currentIndex!=b){if(f.currentIndex=b,!c){var d={index:b};history.pushState(d,"DanZ.im - "+a[b],"#"+a[b])}f.clickHandler(b)}},window.onpopstate=function(a){a.state&&a.state.hasOwnProperty("index")&&f.selectItemAtIndex(a.state.index,!0)},i=0;i<a.length;i++)d=document.createElement("li"),d.innerHTML=a[i],d.onclick=function(){ind=f.indexForItem(this.innerHTML),f.selectItemAtIndex(ind)},g.appendChild(d),c&&i<a.length-1&&f.list.appendChild(document.createElement("hr"));return f.selectItem=function(a){this.selectItemAtIndex(this.indexForItem(a))},f.selectItemAtIndex=function(a,c){for(i=0;i<g.children.length;i++)i==a?g.children[i].classList.add(b.selectedClass):g.children[i].classList.remove(b.selectedClass);e(a,c)},f.indexForItem=function(a){for(i=0;i<g.children.length;i++)if(g.children[i].innerHTML===a)return i},f.previous=function(){this.selectItemAtIndex(0==this.currentIndex?a.length-1:this.currentIndex-1)},f.next=function(){this.selectItemAtIndex(this.currentIndex==a.length-1?0:this.currentIndex+1)},f.addToElement=function(a){a.appendChild(g)},f},a}(),Plates=function(){var a={};return a.initialize=function(a,b,c,d){elm=document.createElement("div"),elm.id="table",document.body.children.length>0?document.body.insertBefore(elm,document.body.firstChild):document.body.appendChild(elm),elm.style.width=c,elm.style.height=d,elm.style.padding="0",elm.style.margin="0",elm.style.top=b,elm.style.left=a,elm.style.position="absolute",elm.style.overflow="hidden"},a.placePlate=function(a){var b={};return b.name=a,b.customStyle=function(){},b.overridecss=!0,b.contentDiv=document.createElement("div"),b.update=function(){var a=document.getElementById("plate-"+this.name);null==a&&(a=document.createElement("div"),a.appendChild(this.contentDiv),a.id="plate-"+this.name,a.classList.add("plate"),document.getElementById("table").appendChild(a),a.style.position="absolute",a.style.display="block",a.style.margin="0",a.style.padding="0"),this.overridecss&&(a.style.top=this.y,a.style.left=this.x,a.style.width=this.width,a.style.height=this.height,a.style.color=this.textColor,a.style.backgroundColor=this.backgroundColor),this.customStyle(a.style)},b.x="0",b.y="0",b.width="100%",b.height="100%",b.backgroundColor="white",b.textColor="black",b.layerLevel=0,b},a}();window.onload=function(){DancingText.dance(),Plates.initialize("0em","0em","100%","100%"),Keys.start();var a,b,c,d,e=["Io","Interessi","Blog","Miscellaneo"],f=ZimmMenu.createMenu(e),g=[],h=0;f.addToElement(document.getElementById("menucontainer")),window.menu=f,document.body.style.width="100%",document.body.style.height="100%";for(i in e)a=e[i],b=Plates.placePlate(a),b.x="10em",b.y="50%",b.width="calc(100% - 20em)",b.height="30em",b.backgroundColor="none",c=b.contentDiv,d=document.getElementById(a.toLowerCase()),c.appendChild(d),d.style.display="block",b.customStyle=function(a){return function(c){var d=90*(4-a),e="rotate("+d+"deg)";c.marginTop="calc(-"+b.height+" / 2)",c.mozTransform=e,c.webkitTransform=e,c.mosTransform=e,c.oTransform=e,c.transform=e}}(h),b.update(),g.push(b),h++;f.clickHandler=function(a){var b,c;for(c=0;4>c;c++)b=g[c],b.customStyle=function(b){return function(c){var d=90*(4-b+a)+360*(ZimmUtil.getRandomInt(0,4)-2),e="rotate("+d+"deg)";c.mozTransform=e,c.webkitTransform=e,c.mosTransform=e,c.oTransform=e,c.transform=e}}(c),b.update()},Keys.registerListener([104,106,107,108,37,38,39,40],!0,function(a){switch(a){case 104:case 37:case 107:case 38:f.previous();break;case 106:case 108:case 40:case 39:f.next()}},"movement");var k=function(a){document.body.style.backgroundColor=a.primary,ZimmUtil.addCSSRule("#menucontainer ul li:hover","background-color: "+a.secondary),ZimmUtil.addCSSRule(".zimmlected","background-color: "+a.darkPrimary),ZimmUtil.addCSSRule(".platecontent","background-color: "+a.darkPrimary),ZimmUtil.addCSSRule("::selection","background-color: "+a.secondary)},l=[{primary:"#C2727C",darkPrimary:"#9E5A63",secondary:"#72C2B8"},{primary:"#72C2B8",darkPrimary:"#5A9E95",secondary:"#C2727C"},{primary:"#3A92C8",darkPrimary:"#2F77A3",secondary:"#C8703A"},{primary:"#C8703A",darkPrimary:"#A35B2F",secondary:"#3A92C8"}],m=Cookies.get("colorscheme");m=""==m?0:parseInt(m),k(l[m]);var n,o,p=!1,q=function(){var a,b;if(p=!p){for(a=0;a<g.length;a++)b=g[a],b.x="calc(100% + 20em)",b.update();document.getElementById("menucontainer").children[0].style.left="-100%";var c=document.createElement("div");c.classList.add("matrixContainer"),c.style.position="absolute",c.style.top=c.style.left="0",c.style.width=c.style.height="100%",n=c,setTimeout(function(){document.body.appendChild(n),Matrix.options.color="#FFF",Matrix.options.fontSize=14,Matrix.options.speed=3,Matrix.options.chance=.99,Matrix.options.tailLength=40;var a=[];for(j=0;1e4>j;j++)a.push(Math.random());Matrix.options.speedForColumn=function(b,c){return 10*Math.pow(Math.sin(4*Math.PI*b/Math.floor(c)),2)+2*a[b]},o=Matrix.fly(c)},500)}else{for(a=0;a<g.length;a++)b=g[a],b.x="10em",b.update();document.getElementById("menucontainer").children[0].style.left="0",Matrix.land(o),document.body.removeChild(n),n=null}},r=function(){m++,m==l.length&&(m=0),Cookies.set("colorscheme",m,365),k(l[m])};Keys.registerCheatCode([38,38,40,40,37,39,37,39,66,65],"cheat1",r),Keys.registerCheatCode([38,38,40,40,37,39,37,39,98,97],"cheat2",r),Keys.registerCheatCode([77,65,84,82,73,88],"cheat3",function(){q()});var s=ZimmBlog.createBlog("http://blog.danz.im/meta","http://blog.danz.im/post/","blog"),t=s.draw();if(t.classList.add("textbloc"),document.getElementById(e[2].toLowerCase()).appendChild(t),s.showPost(0),location.hash&&location.hash.length>0){var u=e.indexOf(location.hash.substring(1));if(-1!=u)return void f.selectItemAtIndex(u,!0)}f.selectItemAtIndex(0)};var ZimmUtil=function(){var a={};return a.objectAtIndex=function(a){return 0>a?a=this.length+a:a>=this.length&&(a=this.length%a),this[a]},a.getRandomInt=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},a.tr=function(a,b,c){var d,e,f="";for(d=0;d<a.length;d++)e=b.indexOf(a[d]),f+=c[e];return f},a.addCSSRule=function(a,b,c){var d=document.styleSheets[0];(void 0===c||-1===c)&&(c=d.cssRules.length),d.insertRule?d.insertRule(a+"{"+b+"}",c):d.addRule(a,b,c)},a.fullSite=function(){},a.mobileSite=function(){},a.fullSiteSize=575,a.updateWindowSize=function(a){a>this.fullSiteSize?this.fullSite():this.mobileSite()},a}();Object.defineProperty(Array.prototype,"objectAtIndex",{value:ZimmUtil.objectAtIndex}),Object.defineProperty(NodeList.prototype,"objectAtIndex",{value:ZimmUtil.objectAtIndex}),Object.defineProperty(HTMLCollection.prototype,"objectAtIndex",{value:ZimmUtil.objectAtIndex}),Object.defineProperty(NodeList.prototype,"forEach",{value:function(a){var b;for(b=0;b<this.length;b++)a(this[b],b,this)}});