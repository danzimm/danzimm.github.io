/*! danzimmjs 01-03-2014 */
var ZimmBlog=function(){var a={},b=function(a,b){return"/"==a[a.length-1]?a+b:a+"/"+b};return a.createBlog=function(a,c,d){var e={},f=-1,g="",h=[],i=0,j=function(){var b,c=new XMLHttpRequest;c.open("GET",a,!1),c.send(),b=JSON.parse(c.responseText),h=b.files,i=b.files.length};return j(),e.draw=function(){var a=document.createElement("div"),b=document.createElement("div"),c=document.createElement("div"),f=document.createElement("div");return b.id=d+"_blog_content",b.classList.add("blogpost"),a.appendChild(b),b.innerHTML=g,c.innerHTML="Previous",f.innerHTML="Next",c.style["float"]="left",f.style["float"]="right",c.classList.add("blognav"),f.classList.add("blognav"),c.id="leftblognav",f.id="rightblognav",c.onclick=function(){e.previous()},f.onclick=function(){e.next()},a.appendChild(c),a.appendChild(f),a},e.showPost=function(a){if(0===i)return document.getElementById("rightblognav").style.display="none",document.getElementById("leftblognav").style.display="none",g="No posts found",void(document.getElementById(d+"_blog_content").innerHTML=g);if(a!=f){f=a;var e=new XMLHttpRequest;e.onreadystatechange=function(){4===e.readyState&&200===e.status&&(g=e.responseText,document.getElementById(d+"_blog_content").innerHTML=g,MathJax.Hub.Queue(["Typeset",MathJax.Hub,d+"_blog_content"]))},e.open("GET",b(c,a),!0),e.send(),document.getElementById("rightblognav").style.display=a===i-1?"none":"block",document.getElementById("leftblognav").style.display=0===a?"none":"block"}},e.next=function(){var a=f;a++,a>=i&&(a=i-1),this.showPost(a)},e.previous=function(){var a=f;a--,0>a&&(a=0),this.showPost(a)},e},a}(),Cookies=function(){var a={};return a.set=function(a,b,c){var d,e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d="expires="+e.toGMTString(),document.cookie=a+"="+b+"; "+d},a.get=function(a){var b,c,d=a+"=",e=document.cookie.split(";");for(b=0;b<e.length;b++)if(c=e[b].trim(),0==c.indexOf(d))return c.substring(d.length,c.length);return""},a}(),DancingText=function(){var a={},b=function(a){var b={};return b.letter=a,b.size="100%",b.html=function(){return'<span class="dancingcharacter" style="font-size: '+this.size+'">'+this.letter+"</span>"},b};return a.dancetext=function(a){var c,d,e=[],f=0,g=a.innerHTML,f=-1;for(c=0;c<g.length;c++)e.push(b(g.charAt(c)));a.innerHTML=e.map(function(a){return a.html()}).join(""),d=function(a){for(a.objectAtIndex(f-1).style.fontSize="100%",a.objectAtIndex(f).style.fontSize="100%",a.objectAtIndex(f+1).style.fontSize="100%",oldindex=f;f==oldindex;)f=ZimmUtil.getRandomInt(0,e.length-1);f>0&&(a.objectAtIndex(f-1).style.fontSize="120%"),a.objectAtIndex(f).style.fontSize="150%",f<a.length-1&&(a.objectAtIndex(f+1).style.fontSize="120%"),setTimeout(d,700,a)},setTimeout(d,10,a.children)},a.dance=function(){var a=document.getElementsByClassName("dancingtext");ZimmUtil.addCSSRule(".dancingcharacter","transition: all 500ms; -webkit-transition: all 500ms;",1);for(var b=0;b<a.length;b++)this.dancetext(a[b])},a}(),Keys=function(){var a={},b=[],c=[],d=function(a){var b,c=[];for(i=0;i<a.length;i++)b=a[i],c.push("string"==typeof b?b.toLowerCase():"number"==typeof b&&b>=65&&90>=b?b+32:b);return c},e=function(a,b,c,e){var f={};return f.caseinsensitive=b,f.letters=f.caseinsensitive?d(a):a,f.callback=c,f.name=e,f};c="qwertyuiopasdfghjklzxcvbnm[]\\;',./`1234567890-=~!@#$%^&*()_+QWERTYUIOP{}|ASDFGHJKL:\"ZXCVBNM<>?".split("").map(function(a){return a.charCodeAt(0)}),a.registerListener=function(a,c,d,f){b.push(e(a,c,d,f))},a.removeListenerForName=function(a){var c,d=[];for(b.forEach(function(b,c){b.name===a&&d.push(c)}),c=d.length-1;c>=0;c--)b.splice(d[c],1)},a.announce=function(a,c,e,f,g){b.forEach(function(b){-1!==b.letters.indexOf(a)?b.callback(a,c,e,f,g):b.caseinsensitive&&-1!==b.letters.indexOf(d([a])[0])&&b.callback(d([a])[0],c,e,f,g)})},a.registerCheatCode=function(a,b,d){var e=0;this.registerListener(a.concat(c),!1,function(c){c===a[e]?e++:e=0,e==a.length&&(d(b),e=0)},b)};var f=function(b){a.announce(b.keyCode,b.shiftKey,b.altKey,b.metaKey,b.ctrlKey)};return a.start=function(){window.onkeydown=f},a.stop=function(){window.onkeydown=null},a}(),Matrix=function(){var a={},b={color:"#0F0",fontFamily:"Monaco",fontSize:15,letters:"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",speed:3,chance:.975,speedForColumn:function(){return 1},tailLength:10,letterRestriction:function(){return null}};a.letters={},a.letters.chinese="田由甲申甴电甶男甸甹町画甼甽甾甿畀畁畂畃畄畅畆畇畈畉畊畋界畍畎畏畐畑",a.letters.lowercaseEnglish="abcdefghijklmnopqrstuvwxyz",a.letters.uppercaseEnglish=a.letters.lowercaseEnglish.toUpperCase(),a.letters.digits="0123456789",a.letters.leet="1337leet",a.resetOptions=function(){a.options={};for(key in b)a.options[key]=b[key]},a.resetOptions();var c=function(a){var b=document.createElement("span"),c=0;return b.style.fontSize=a+"px",b.innerHTML="x",b.style.margin=b.style.padding="0",document.body.appendChild(b),c=b.offsetWidth,document.body.removeChild(b),c},d=function(a){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(b,function(a,b,c,d){return b+b+c+c+d+d});var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return c?{r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16)}:null},e=function(a){return new Array(a).join(" ")};return a.fly=function(b){var f,g,h,i,j,k,l=document.createElement("canvas"),m=l.getContext("2d"),n=a.options.letters+e(Math.floor(a.options.letters.length/2)),o=n.split(""),p=[],q=d(a.options.color),r="rgba("+q.r+","+q.g+","+q.b+",",s=c(a.options.fontSize),t={canvas:l,elm:b};for(b.appendChild(l),l.width=b.clientWidth,l.height=b.clientHeight,i=Math.floor(l.width/s)+1,j=Math.floor(l.height/a.options.fontSize)+1,t.ncol=i,t.nrow=j,f=new Array(i),k=new Array(k),g=0;i>g;g++){for(p.push(new Array(j)),h=0;j>h;h++)p[g][h]={alpha:0,letter:" "};f[g]=0,p[g].ready=!0,k[g]=a.options.speedForColumn(g,i)}t.drops=p,t.stop=!1;var u=function(a,b,c,d,e,n){for(m.clearRect(0,0,l.width,l.height),m.font=a+"px "+c,g=0;i>g;g++){f[g]++;var q=!1,s=f[g]>k[g];for(s&&(f[g]=0),h=0;j>h;h++){var u=p[g][h];s&&(1===u.alpha?(q=!0,u.alpha-=1/(e+1)):q?(q=!1,u.alpha=1,u.letter=n(g,h)||o[Math.floor(Math.random()*o.length)],h===j-1&&(p[g].ready=!0)):u.alpha-=1/(e+1)),m.fillStyle=r+u.alpha+")",m.fillText(u.letter,g*b,h*a)}!t.stop&&p[g].ready&&p[g][j-1].alpha<=0&&Math.random()>d&&(p[g].ready=!1,p[g][0].alpha=1,p[g][0].letter=o[Math.floor(Math.random()*o.length)])}};return t.id=setInterval(u,100/a.options.speed,a.options.fontSize,s,a.options.fontFamily,a.options.chance,a.options.tailLength,a.options.letterRestriction),t},a.land=function(a,b){var c,d=0,e=function(){clearInterval(c),clearInterval(a.id),a.elm.removeChild(a.canvas),b()};a.stop=!0;var f=function(){if(d===a.ncol)e();else if(a.drops[d].ready&&a.drops[d][a.nrow-1].alpha<=0)for(;a.drops[d]&&a.drops[d].ready&&a.drops[d][a.nrow-1].alpha<=0;)d++};c=setInterval(f,33)},a}(),ZimmMenu=function(){var a={},b=a;return a.selectedClass="zimmlected",a.createMenu=function(a,c){var d,e,f={},g=document.createElement("ul");for(f.currentIndex=-1,f.clickHandler=function(){},e=function(b,c){if(f.currentIndex!=b){if(f.currentIndex=b,!c){var d={index:b};history.pushState(d,"DanZ.im - "+a[b],"#"+a[b])}f.clickHandler(b)}},window.onpopstate=function(a){a.state&&a.state.hasOwnProperty("index")&&f.selectItemAtIndex(a.state.index,!0)},i=0;i<a.length;i++)d=document.createElement("li"),d.innerHTML=a[i],d.onclick=function(){ind=f.indexForItem(this.innerHTML),f.selectItemAtIndex(ind)},g.appendChild(d),c&&i<a.length-1&&f.list.appendChild(document.createElement("hr"));return f.selectItem=function(a){this.selectItemAtIndex(this.indexForItem(a))},f.selectItemAtIndex=function(a,c){for(i=0;i<g.children.length;i++)i==a?g.children[i].classList.add(b.selectedClass):g.children[i].classList.remove(b.selectedClass);e(a,c)},f.indexForItem=function(a){for(i=0;i<g.children.length;i++)if(g.children[i].innerHTML===a)return i},f.previous=function(){this.selectItemAtIndex(0==this.currentIndex?a.length-1:this.currentIndex-1)},f.next=function(){this.selectItemAtIndex(this.currentIndex==a.length-1?0:this.currentIndex+1)},f.addToElement=function(a){a.appendChild(g)},f},a}(),Plates=function(){var a={};return a.initialize=function(a,b,c,d){elm=document.createElement("div"),elm.id="table",document.body.children.length>0?document.body.insertBefore(elm,document.body.firstChild):document.body.appendChild(elm),elm.style.width=c,elm.style.height=d,elm.style.padding="0",elm.style.margin="0",elm.style.top=b,elm.style.left=a,elm.style.position="absolute",elm.style.overflow="hidden"},a.placePlate=function(a){var b={};return b.name=a,b.customStyle=function(){},b.overridecss=!0,b.contentDiv=document.createElement("div"),b.update=function(){var a=document.getElementById("plate-"+this.name);null==a&&(a=document.createElement("div"),a.appendChild(this.contentDiv),a.id="plate-"+this.name,a.classList.add("plate"),document.getElementById("table").appendChild(a),a.style.position="absolute",a.style.display="block",a.style.margin="0",a.style.padding="0"),this.overridecss&&(a.style.top=this.y,a.style.left=this.x,a.style.width=this.width,a.style.height=this.height,a.style.color=this.textColor,a.style.backgroundColor=this.backgroundColor),this.customStyle(a.style)},b.x="0",b.y="0",b.width="100%",b.height="100%",b.backgroundColor="white",b.textColor="black",b.layerLevel=0,b},a}();window.onload=function(){var a=!0;DancingText.dance(),Plates.initialize("0em","0em","100%","100%"),Keys.start();var b,c,d,e,f=["Io","Interessi","Blog","Miscellaneo"],g=ZimmMenu.createMenu(f),h=[],k=0;g.addToElement(document.getElementById("menucontainer")),window.menu=g,document.body.style.width="100%",document.body.style.height="100%";for(i in f)b=f[i],c=Plates.placePlate(b),c.x="10em",c.y="50%",c.width="calc(100% - 20em)",c.height="30em",c.backgroundColor="none",d=c.contentDiv,e=document.getElementById(b.toLowerCase()),d.appendChild(e),e.style.display="block",c.customStyle=function(a){return function(b){var d=90*(4-a),e="rotate("+d+"deg)";b.marginTop="calc(-"+c.height+" / 2)",b.mozTransform=e,b.webkitTransform=e,b.mosTransform=e,b.oTransform=e,b.transform=e}}(k),c.update(),h.push(c),k++;g.clickHandler=function(a){var b,c;for(c=0;4>c;c++)b=h[c],b.customStyle=function(b){return function(c){var d=90*(4-b+a)+360*(ZimmUtil.getRandomInt(0,4)-2),e="rotate("+d+"deg)";c.mozTransform=e,c.webkitTransform=e,c.mosTransform=e,c.oTransform=e,c.transform=e}}(c),b.update()},Keys.registerListener([104,106,107,108,37,38,39,40],!0,function(a){switch(a){case 104:case 37:case 107:case 38:g.previous();break;case 106:case 108:case 40:case 39:g.next()}},"movement");var l=function(a){document.body.style.backgroundColor=a.primary,ZimmUtil.addCSSRule("#menucontainer ul li:hover","background-color: "+a.secondary),ZimmUtil.addCSSRule(".zimmlected","background-color: "+a.darkPrimary),ZimmUtil.addCSSRule(".platecontent","background-color: "+a.darkPrimary),ZimmUtil.addCSSRule("::selection","background-color: "+a.secondary),ZimmUtil.addCSSRule("a:hover","background-color: "+a.secondary)},m=[{primary:"#C2727C",darkPrimary:"#9E5A63",secondary:"#72C2B8"},{primary:"#72C2B8",darkPrimary:"#5A9E95",secondary:"#C2727C"},{primary:"#3A92C8",darkPrimary:"#2F77A3",secondary:"#C8703A"},{primary:"#C8703A",darkPrimary:"#A35B2F",secondary:"#3A92C8"},{primary:"#ADD683",darkPrimary:"#93B570",secondary:"#AC83D6"},{primary:"#AC83D6",darkPrimary:"#9270B5",secondary:"#ADD683"}],n=Cookies.get("colorscheme");n=""==n?0:parseInt(n),l(m[n]);var o,p,q=!1,r=function(){if(q=!q){var a=document.createElement("div");a.classList.add("matrixContainer"),a.style.position="absolute",a.style.top=a.style.left="0",a.style.width=a.style.height="100%",o=a,document.body.insertBefore(o,document.body.firstChild),Matrix.options.color="#FFF",Matrix.options.fontSize=15,Matrix.options.speed=3,Matrix.options.chance=.975,Matrix.options.tailLength=40;var b="I am DanZ.im";Matrix.options.letterRestriction=function(a,c){return 10===c&&a>=1&&a<=1+b.length?b[a-1]:null};var c=[];for(j=0;1e4>j;j++)c.push(Math.random());Matrix.options.speedForColumn=function(a,b){return 3*Math.pow(Math.sin(4*Math.PI*a/Math.floor(b)),2)+2*c[a]},p=Matrix.fly(a)}else Matrix.land(p,function(){document.body.removeChild(o),o=null})},s=function(){n++,n==m.length&&(n=0),Cookies.set("colorscheme",n,365),l(m[n])};Keys.registerCheatCode([38,38,40,40,37,39,37,39,66,65],"cheat1",s),Keys.registerCheatCode([77,65,84,82,73,88],"cheat2",function(){r()}),Keys.registerCheatCode([82,82],"cheat3",function(){for(var a=g.currentIndex;a===g.currentIndex;)a=ZimmUtil.getRandomInt(0,f.length-1);g.selectItemAtIndex(a)});var t=a?"http://blog.danz.im":"http://localhost:3002",u=ZimmBlog.createBlog(t+"/meta",t+"/post/","blog"),v=u.draw();if(v.classList.add("textbloc"),document.getElementById(f[2].toLowerCase()).appendChild(v),u.showPost(0),location.hash&&location.hash.length>0){var w=f.indexOf(location.hash.substring(1));if(-1!=w)return void g.selectItemAtIndex(w,!0)}g.selectItemAtIndex(0)};var ZimmUtil=function(){var a={};return a.objectAtIndex=function(a){return 0>a?a=this.length+a:a>=this.length&&(a=this.length%a),this[a]},a.getRandomInt=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},a.tr=function(a,b,c){var d,e,f="";for(d=0;d<a.length;d++)e=b.indexOf(a[d]),f+=c[e];return f},a.addCSSRule=function(a,b,c){var d=document.styleSheets[0];(void 0===c||-1===c)&&(c=d.cssRules.length),d.insertRule?d.insertRule(a+"{"+b+"}",c):d.addRule(a,b,c)},a.fullSite=function(){},a.mobileSite=function(){},a.fullSiteSize=575,a.updateWindowSize=function(a){a>this.fullSiteSize?this.fullSite():this.mobileSite()},a}();Object.defineProperty(Array.prototype,"objectAtIndex",{value:ZimmUtil.objectAtIndex}),Object.defineProperty(NodeList.prototype,"objectAtIndex",{value:ZimmUtil.objectAtIndex}),Object.defineProperty(HTMLCollection.prototype,"objectAtIndex",{value:ZimmUtil.objectAtIndex}),Object.defineProperty(NodeList.prototype,"forEach",{value:function(a){var b;for(b=0;b<this.length;b++)a(this[b],b,this)}});